#!/bin/sh

set -e

if [ "$1" = "upgrade" ] || [ "$1" = "install" ]; then
	for f in nvidia/ga102/acr/ucode_ahesasc.bin nvidia/ga102/acr/ucode_asb.bin nvidia/ga102/acr/ucode_unload.bin nvidia/ga102/gr/NET_img.bin nvidia/ga102/gr/fecs_bl.bin nvidia/ga102/gr/fecs_sig.bin nvidia/ga102/gr/gpccs_bl.bin nvidia/ga102/gr/gpccs_sig.bin nvidia/ga102/nvdec/scrubber.bin nvidia/ga102/sec2/desc.bin nvidia/ga102/sec2/hs_bl_sig.bin nvidia/ga102/sec2/image.bin nvidia/ga102/sec2/sig.bin nvidia/ga103/gr/NET_img.bin nvidia/ga103/gr/fecs_bl.bin nvidia/ga103/gr/fecs_sig.bin nvidia/ga103/gr/gpccs_bl.bin nvidia/ga103/gr/gpccs_sig.bin nvidia/ga104/gr/NET_img.bin nvidia/ga104/gr/fecs_bl.bin nvidia/ga104/gr/fecs_sig.bin nvidia/ga104/gr/gpccs_bl.bin nvidia/ga104/gr/gpccs_sig.bin nvidia/ga106/gr/NET_img.bin nvidia/ga106/gr/fecs_bl.bin nvidia/ga106/gr/fecs_sig.bin nvidia/ga106/gr/gpccs_bl.bin nvidia/ga106/gr/gpccs_sig.bin nvidia/ga107/gr/NET_img.bin nvidia/ga107/gr/fecs_bl.bin nvidia/ga107/gr/fecs_sig.bin nvidia/ga107/gr/gpccs_bl.bin nvidia/ga107/gr/gpccs_sig.bin nvidia/gk20a/fecs_data.bin nvidia/gk20a/fecs_inst.bin nvidia/gk20a/gpccs_data.bin nvidia/gk20a/gpccs_inst.bin nvidia/gk20a/sw_bundle_init.bin nvidia/gk20a/sw_ctx.bin nvidia/gk20a/sw_method_init.bin nvidia/gk20a/sw_nonctx.bin nvidia/gm200/acr/bl.bin nvidia/gm200/acr/ucode_load.bin nvidia/gm200/acr/ucode_unload.bin nvidia/gm200/gr/fecs_bl.bin nvidia/gm200/gr/fecs_data.bin nvidia/gm200/gr/fecs_inst.bin nvidia/gm200/gr/fecs_sig.bin nvidia/gm200/gr/gpccs_bl.bin nvidia/gm200/gr/gpccs_data.bin nvidia/gm200/gr/gpccs_inst.bin nvidia/gm200/gr/gpccs_sig.bin nvidia/gm200/gr/sw_bundle_init.bin nvidia/gm200/gr/sw_ctx.bin nvidia/gm200/gr/sw_method_init.bin nvidia/gm200/gr/sw_nonctx.bin nvidia/gm204/acr/bl.bin nvidia/gm204/acr/ucode_load.bin nvidia/gm204/acr/ucode_unload.bin nvidia/gm204/gr/fecs_bl.bin nvidia/gm204/gr/fecs_data.bin nvidia/gm204/gr/fecs_inst.bin nvidia/gm204/gr/fecs_sig.bin nvidia/gm204/gr/gpccs_bl.bin nvidia/gm204/gr/gpccs_data.bin nvidia/gm204/gr/gpccs_inst.bin nvidia/gm204/gr/gpccs_sig.bin nvidia/gm204/gr/sw_bundle_init.bin nvidia/gm204/gr/sw_ctx.bin nvidia/gm204/gr/sw_method_init.bin nvidia/gm204/gr/sw_nonctx.bin nvidia/gm206/acr/bl.bin nvidia/gm206/acr/ucode_load.bin nvidia/gm206/acr/ucode_unload.bin nvidia/gm206/gr/fecs_bl.bin nvidia/gm206/gr/fecs_data.bin nvidia/gm206/gr/fecs_inst.bin nvidia/gm206/gr/fecs_sig.bin nvidia/gm206/gr/gpccs_bl.bin nvidia/gm206/gr/gpccs_data.bin nvidia/gm206/gr/gpccs_inst.bin nvidia/gm206/gr/gpccs_sig.bin nvidia/gm206/gr/sw_bundle_init.bin nvidia/gm206/gr/sw_ctx.bin nvidia/gm206/gr/sw_method_init.bin nvidia/gm206/gr/sw_nonctx.bin nvidia/gm20b/acr/bl.bin nvidia/gm20b/acr/ucode_load.bin nvidia/gm20b/gr/fecs_bl.bin nvidia/gm20b/gr/fecs_data.bin nvidia/gm20b/gr/fecs_inst.bin nvidia/gm20b/gr/fecs_sig.bin nvidia/gm20b/gr/gpccs_data.bin nvidia/gm20b/gr/gpccs_inst.bin nvidia/gm20b/gr/sw_bundle_init.bin nvidia/gm20b/gr/sw_ctx.bin nvidia/gm20b/gr/sw_method_init.bin nvidia/gm20b/gr/sw_nonctx.bin nvidia/gm20b/pmu/desc.bin nvidia/gm20b/pmu/image.bin nvidia/gm20b/pmu/sig.bin nvidia/gp100/acr/bl.bin nvidia/gp100/acr/ucode_load.bin nvidia/gp100/acr/ucode_unload.bin nvidia/gp100/gr/fecs_bl.bin nvidia/gp100/gr/fecs_data.bin nvidia/gp100/gr/fecs_inst.bin nvidia/gp100/gr/fecs_sig.bin nvidia/gp100/gr/gpccs_bl.bin nvidia/gp100/gr/gpccs_data.bin nvidia/gp100/gr/gpccs_inst.bin nvidia/gp100/gr/gpccs_sig.bin nvidia/gp100/gr/sw_bundle_init.bin nvidia/gp100/gr/sw_ctx.bin nvidia/gp100/gr/sw_method_init.bin nvidia/gp100/gr/sw_nonctx.bin nvidia/gp102/acr/bl.bin nvidia/gp102/acr/ucode_load.bin nvidia/gp102/acr/ucode_unload.bin nvidia/gp102/acr/unload_bl.bin nvidia/gp102/gr/fecs_bl.bin nvidia/gp102/gr/fecs_data.bin nvidia/gp102/gr/fecs_inst.bin nvidia/gp102/gr/fecs_sig.bin nvidia/gp102/gr/gpccs_bl.bin nvidia/gp102/gr/gpccs_data.bin nvidia/gp102/gr/gpccs_inst.bin nvidia/gp102/gr/gpccs_sig.bin nvidia/gp102/gr/sw_bundle_init.bin nvidia/gp102/gr/sw_ctx.bin nvidia/gp102/gr/sw_method_init.bin nvidia/gp102/gr/sw_nonctx.bin nvidia/gp102/nvdec/scrubber.bin nvidia/gp102/sec2/desc-1.bin nvidia/gp102/sec2/desc.bin nvidia/gp102/sec2/image-1.bin nvidia/gp102/sec2/image.bin nvidia/gp102/sec2/sig-1.bin nvidia/gp102/sec2/sig.bin nvidia/gp104/acr/bl.bin nvidia/gp104/acr/ucode_load.bin nvidia/gp104/acr/ucode_unload.bin nvidia/gp104/acr/unload_bl.bin nvidia/gp104/gr/fecs_bl.bin nvidia/gp104/gr/fecs_data.bin nvidia/gp104/gr/fecs_inst.bin nvidia/gp104/gr/fecs_sig.bin nvidia/gp104/gr/gpccs_bl.bin nvidia/gp104/gr/gpccs_data.bin nvidia/gp104/gr/gpccs_inst.bin nvidia/gp104/gr/gpccs_sig.bin nvidia/gp104/gr/sw_bundle_init.bin nvidia/gp104/gr/sw_ctx.bin nvidia/gp104/gr/sw_method_init.bin nvidia/gp104/gr/sw_nonctx.bin nvidia/gp104/nvdec/scrubber.bin nvidia/gp104/sec2/desc-1.bin nvidia/gp104/sec2/desc.bin nvidia/gp104/sec2/image-1.bin nvidia/gp104/sec2/image.bin nvidia/gp104/sec2/sig-1.bin nvidia/gp104/sec2/sig.bin nvidia/gp106/acr/bl.bin nvidia/gp106/acr/ucode_load.bin nvidia/gp106/acr/ucode_unload.bin nvidia/gp106/acr/unload_bl.bin nvidia/gp106/gr/fecs_bl.bin nvidia/gp106/gr/fecs_data.bin nvidia/gp106/gr/fecs_inst.bin nvidia/gp106/gr/fecs_sig.bin nvidia/gp106/gr/gpccs_bl.bin nvidia/gp106/gr/gpccs_data.bin nvidia/gp106/gr/gpccs_inst.bin nvidia/gp106/gr/gpccs_sig.bin nvidia/gp106/gr/sw_bundle_init.bin nvidia/gp106/gr/sw_ctx.bin nvidia/gp106/gr/sw_method_init.bin nvidia/gp106/gr/sw_nonctx.bin nvidia/gp106/nvdec/scrubber.bin nvidia/gp106/sec2/desc-1.bin nvidia/gp106/sec2/desc.bin nvidia/gp106/sec2/image-1.bin nvidia/gp106/sec2/image.bin nvidia/gp106/sec2/sig-1.bin nvidia/gp106/sec2/sig.bin nvidia/gp107/acr/bl.bin nvidia/gp107/acr/ucode_load.bin nvidia/gp107/acr/ucode_unload.bin nvidia/gp107/acr/unload_bl.bin nvidia/gp107/gr/fecs_bl.bin nvidia/gp107/gr/fecs_data.bin nvidia/gp107/gr/fecs_inst.bin nvidia/gp107/gr/fecs_sig.bin nvidia/gp107/gr/gpccs_bl.bin nvidia/gp107/gr/gpccs_data.bin nvidia/gp107/gr/gpccs_inst.bin nvidia/gp107/gr/gpccs_sig.bin nvidia/gp107/gr/sw_bundle_init.bin nvidia/gp107/gr/sw_ctx.bin nvidia/gp107/gr/sw_method_init.bin nvidia/gp107/gr/sw_nonctx.bin nvidia/gp107/nvdec/scrubber.bin nvidia/gp107/sec2/desc-1.bin nvidia/gp107/sec2/desc.bin nvidia/gp107/sec2/image-1.bin nvidia/gp107/sec2/image.bin nvidia/gp107/sec2/sig-1.bin nvidia/gp107/sec2/sig.bin nvidia/gp108/acr/bl.bin nvidia/gp108/acr/ucode_load.bin nvidia/gp108/acr/ucode_unload.bin nvidia/gp108/acr/unload_bl.bin nvidia/gp108/gr/fecs_bl.bin nvidia/gp108/gr/fecs_data.bin nvidia/gp108/gr/fecs_inst.bin nvidia/gp108/gr/fecs_sig.bin nvidia/gp108/gr/gpccs_bl.bin nvidia/gp108/gr/gpccs_data.bin nvidia/gp108/gr/gpccs_inst.bin nvidia/gp108/gr/gpccs_sig.bin nvidia/gp108/gr/sw_bundle_init.bin nvidia/gp108/gr/sw_ctx.bin nvidia/gp108/gr/sw_method_init.bin nvidia/gp108/gr/sw_nonctx.bin nvidia/gp108/nvdec/scrubber.bin nvidia/gp108/sec2/desc.bin nvidia/gp108/sec2/image.bin nvidia/gp108/sec2/sig.bin nvidia/gp10b/acr/bl.bin nvidia/gp10b/acr/ucode_load.bin nvidia/gp10b/gr/fecs_bl.bin nvidia/gp10b/gr/fecs_data.bin nvidia/gp10b/gr/fecs_inst.bin nvidia/gp10b/gr/fecs_sig.bin nvidia/gp10b/gr/gpccs_bl.bin nvidia/gp10b/gr/gpccs_data.bin nvidia/gp10b/gr/gpccs_inst.bin nvidia/gp10b/gr/gpccs_sig.bin nvidia/gp10b/gr/sw_bundle_init.bin nvidia/gp10b/gr/sw_ctx.bin nvidia/gp10b/gr/sw_method_init.bin nvidia/gp10b/gr/sw_nonctx.bin nvidia/gp10b/pmu/desc.bin nvidia/gp10b/pmu/image.bin nvidia/gp10b/pmu/sig.bin nvidia/gv100/acr/bl.bin nvidia/gv100/acr/ucode_load.bin nvidia/gv100/acr/ucode_unload.bin nvidia/gv100/acr/unload_bl.bin nvidia/gv100/gr/fecs_bl.bin nvidia/gv100/gr/fecs_data.bin nvidia/gv100/gr/fecs_inst.bin nvidia/gv100/gr/fecs_sig.bin nvidia/gv100/gr/gpccs_bl.bin nvidia/gv100/gr/gpccs_data.bin nvidia/gv100/gr/gpccs_inst.bin nvidia/gv100/gr/gpccs_sig.bin nvidia/gv100/gr/sw_bundle_init.bin nvidia/gv100/gr/sw_ctx.bin nvidia/gv100/gr/sw_method_init.bin nvidia/gv100/gr/sw_nonctx.bin nvidia/gv100/nvdec/scrubber.bin nvidia/gv100/sec2/desc.bin nvidia/gv100/sec2/image.bin nvidia/gv100/sec2/sig.bin nvidia/tu102/acr/bl.bin nvidia/tu102/acr/ucode_ahesasc.bin nvidia/tu102/acr/ucode_asb.bin nvidia/tu102/acr/ucode_unload.bin nvidia/tu102/acr/unload_bl.bin nvidia/tu102/gr/fecs_bl.bin nvidia/tu102/gr/fecs_data.bin nvidia/tu102/gr/fecs_inst.bin nvidia/tu102/gr/fecs_sig.bin nvidia/tu102/gr/gpccs_bl.bin nvidia/tu102/gr/gpccs_data.bin nvidia/tu102/gr/gpccs_inst.bin nvidia/tu102/gr/gpccs_sig.bin nvidia/tu102/gr/sw_bundle_init.bin nvidia/tu102/gr/sw_ctx.bin nvidia/tu102/gr/sw_method_init.bin nvidia/tu102/gr/sw_nonctx.bin nvidia/tu102/gr/sw_veid_bundle_init.bin nvidia/tu102/nvdec/scrubber.bin nvidia/tu102/sec2/desc.bin nvidia/tu102/sec2/image.bin nvidia/tu102/sec2/sig.bin nvidia/tu104/acr/bl.bin nvidia/tu104/acr/ucode_ahesasc.bin nvidia/tu104/acr/ucode_asb.bin nvidia/tu104/acr/ucode_unload.bin nvidia/tu104/acr/unload_bl.bin nvidia/tu104/gr/fecs_bl.bin nvidia/tu104/gr/fecs_data.bin nvidia/tu104/gr/fecs_inst.bin nvidia/tu104/gr/fecs_sig.bin nvidia/tu104/gr/gpccs_bl.bin nvidia/tu104/gr/gpccs_data.bin nvidia/tu104/gr/gpccs_inst.bin nvidia/tu104/gr/gpccs_sig.bin nvidia/tu104/gr/sw_bundle_init.bin nvidia/tu104/gr/sw_ctx.bin nvidia/tu104/gr/sw_method_init.bin nvidia/tu104/gr/sw_nonctx.bin nvidia/tu104/gr/sw_veid_bundle_init.bin nvidia/tu104/nvdec/scrubber.bin nvidia/tu104/sec2/desc.bin nvidia/tu104/sec2/image.bin nvidia/tu104/sec2/sig.bin nvidia/tu106/acr/bl.bin nvidia/tu106/acr/ucode_ahesasc.bin nvidia/tu106/acr/ucode_asb.bin nvidia/tu106/acr/ucode_unload.bin nvidia/tu106/acr/unload_bl.bin nvidia/tu106/gr/fecs_bl.bin nvidia/tu106/gr/fecs_data.bin nvidia/tu106/gr/fecs_inst.bin nvidia/tu106/gr/fecs_sig.bin nvidia/tu106/gr/gpccs_bl.bin nvidia/tu106/gr/gpccs_data.bin nvidia/tu106/gr/gpccs_inst.bin nvidia/tu106/gr/gpccs_sig.bin nvidia/tu106/gr/sw_bundle_init.bin nvidia/tu106/gr/sw_ctx.bin nvidia/tu106/gr/sw_method_init.bin nvidia/tu106/gr/sw_nonctx.bin nvidia/tu106/gr/sw_veid_bundle_init.bin nvidia/tu106/nvdec/scrubber.bin nvidia/tu106/sec2/desc.bin nvidia/tu106/sec2/image.bin nvidia/tu106/sec2/sig.bin nvidia/tu10x/typec/ccg_boot.cyacd nvidia/tu10x/typec/ccg_primary.cyacd nvidia/tu10x/typec/ccg_secondary.cyacd nvidia/tu116/acr/bl.bin nvidia/tu116/acr/ucode_ahesasc.bin nvidia/tu116/acr/ucode_asb.bin nvidia/tu116/acr/ucode_unload.bin nvidia/tu116/acr/unload_bl.bin nvidia/tu116/gr/fecs_bl.bin nvidia/tu116/gr/fecs_data.bin nvidia/tu116/gr/fecs_inst.bin nvidia/tu116/gr/fecs_sig.bin nvidia/tu116/gr/gpccs_bl.bin nvidia/tu116/gr/gpccs_data.bin nvidia/tu116/gr/gpccs_inst.bin nvidia/tu116/gr/gpccs_sig.bin nvidia/tu116/gr/sw_bundle_init.bin nvidia/tu116/gr/sw_ctx.bin nvidia/tu116/gr/sw_method_init.bin nvidia/tu116/gr/sw_nonctx.bin nvidia/tu116/gr/sw_veid_bundle_init.bin nvidia/tu116/nvdec/scrubber.bin nvidia/tu116/sec2/desc.bin nvidia/tu116/sec2/image.bin nvidia/tu116/sec2/sig.bin nvidia/tu117/acr/bl.bin nvidia/tu117/acr/ucode_ahesasc.bin nvidia/tu117/acr/ucode_asb.bin nvidia/tu117/acr/ucode_unload.bin nvidia/tu117/acr/unload_bl.bin nvidia/tu117/gr/fecs_bl.bin nvidia/tu117/gr/fecs_data.bin nvidia/tu117/gr/fecs_inst.bin nvidia/tu117/gr/fecs_sig.bin nvidia/tu117/gr/gpccs_bl.bin nvidia/tu117/gr/gpccs_data.bin nvidia/tu117/gr/gpccs_inst.bin nvidia/tu117/gr/gpccs_sig.bin nvidia/tu117/gr/sw_bundle_init.bin nvidia/tu117/gr/sw_ctx.bin nvidia/tu117/gr/sw_method_init.bin nvidia/tu117/gr/sw_nonctx.bin nvidia/tu117/gr/sw_veid_bundle_init.bin nvidia/tu117/nvdec/scrubber.bin nvidia/tu117/sec2/desc.bin nvidia/tu117/sec2/image.bin nvidia/tu117/sec2/sig.bin; do
		dpkg-divert --package firmware-nvidia-graphics --no-rename --quiet \
			--divert "/lib/firmware/$f.usr-is-merged" \
			--add "/lib/firmware/$f"
	done
fi



exit 0
